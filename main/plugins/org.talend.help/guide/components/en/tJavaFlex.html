<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>tJavaFlex</title><meta name="generator" content="DocBook XSL-NS Stylesheets V1.75.2"><link rel="home" href="bk-tos-components-rg-en..html" title="Talend Open Studio Components"><link rel="up" href="ch-customcode.html" title="Chapter&nbsp;5.&nbsp;Custom Code components"><link rel="prev" href="tJava.html" title="tJava"><link rel="next" href="tJavaRow.html" title="tJavaRow"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">tJavaFlex</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="tJava.html">Prev</a>&nbsp;</td><th width="60%" align="center">Chapter&nbsp;5.&nbsp;Custom Code components</th><td width="20%" align="right">&nbsp;<a accesskey="n" href="tJavaRow.html">Next</a></td></tr></table><hr></div><div lang="EN" class="section" title="tJavaFlex"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="tJavaFlex"></a>tJavaFlex</h2></div></div></div><div class="mediaobject"><img src="../images/tJavaFlex_icon32.png"></div><div class="section" title="tJavaFlex properties"><div class="titlepage"><div><div><h3 class="title"><a name="d0e55920"></a>tJavaFlex properties</h3></div></div></div><div class="informaltable"><table border="1"><colgroup><col><col><col></colgroup><tbody><tr><td valign="top">
                            <p><span class="emphasis"><strong>Component family</strong></span></p>
                        </td><td valign="top">
                            <p>Custom Code</p>
                        </td><td valign="top">&nbsp;</td></tr><tr><td valign="top">
                            <p><span class="emphasis"><strong>Function</strong></span></p>
                        </td><td colspan="2" valign="top">
                            <p><span class="emphasis"><strong>tJavaFlex</strong></span> enables you to enter
                                personalized code in order to integrate it in <span class="emphasis"><strong>Talend</strong></span> program. With <span class="emphasis"><strong>tJavaFlex</strong></span>, you can enter the three java-code parts
                                (start, main and end) that constitute a kind of component dedicated
                                to do a desired operation.</p>
                        </td></tr><tr><td valign="top">
                            <p><span class="emphasis"><strong>Objective</strong></span></p>
                        </td><td colspan="2" valign="top">
                            
                            <p><span class="emphasis"><strong>tJavaFlex</strong></span> lets you add Java code
                                to the Start/Main/End code sections of this component itself. </p>
                            
                            
                        </td></tr><tr><td valign="top">
                            <p><span class="emphasis"><strong>Basic settings</strong></span></p>
                        </td><td valign="top">
                            <p><span class="emphasis"><em>Schema </em></span>and <span class="emphasis"><em>Edit
                                Schema</em></span></p>
                        </td><td valign="top">
                            <p>A schema is a row description, i.e., it defines the number of
                                fields to be processed and passed on to the next component. <span>The schema is either <span class="emphasis"><strong>Built-in</strong></span> or stored remotely in the
                                        <span class="emphasis"><strong>Repository</strong></span></span>.</p>
                            <p>Click <span class="emphasis"><strong>Edit Schema</strong></span> to make changes
                                to the schema. <span>Note that if you make
                                    changes, the schema automatically becomes <span class="emphasis"><strong>Built-in</strong></span>.</span></p>
                            <p>Click <span class="emphasis"><strong>Sync columns</strong></span> to retrieve
                                the schema from the previous component in the Job.</p>
                            
                        </td></tr><tr><td>
                            <p>&nbsp;</p>
                        </td><td>
                            <p>&nbsp;</p>
                        </td><td valign="top">
                            <p><span class="emphasis"><strong>Built-in</strong></span>: The schema is created
                                and stored locally for this component only. Related topic: see
                                        <span class="emphasis"><em>Talend Open Studio User Guide</em></span>.</p>
                        </td></tr><tr><td>
                            <p>&nbsp;</p>
                        </td><td>
                            <p>&nbsp;</p>
                        </td><td valign="top">
                            <p><span class="emphasis"><strong>Repository</strong></span>: The schema already
                                exists and is stored in the Repository, hence can be reused. Related
                                topic: see <span class="emphasis"><em>Talend Open Studio User Guide</em></span>.</p>
                        </td></tr><tr><td>
                            <p>&nbsp;</p>
                        </td><td valign="top">
                            <p><span class="emphasis"><em>Data Auto Propagate</em></span></p>
                        </td><td valign="top">
                            <p>Select this check box to automatically propagate the data to the
                                component that follows.</p>
                        </td></tr><tr><td>
                            <p>&nbsp;</p>
                        </td><td valign="top">
                            <p><span class="emphasis"><em>Start code</em></span></p>
                        </td><td valign="top">
                            <p>Enter the Java code that will be called during the initialization
                                phase.</p>
                        </td></tr><tr><td>
                            <p>&nbsp;</p>
                        </td><td valign="top">
                            <p><span class="emphasis"><em>Main code</em></span></p>
                        </td><td valign="top">
                            <p>Enter the Java code to be applied for each line in the data
                                flow.</p>
                        </td></tr><tr><td>
                            <p>&nbsp;</p>
                        </td><td valign="top">
                            <p><span class="emphasis"><em>End code</em></span></p>
                        </td><td valign="top">
                            <p>Enter the Java code that will be called during the closing
                                phase.</p>
                        </td></tr><tr><td valign="top">
                            <p><span class="emphasis"><strong>Advanced settings</strong></span></p>
                        </td><td valign="top">
                            <p><span class="emphasis"><em>Import</em></span></p>
                        </td><td valign="top">
                            <p>Enter the Java code that helps to import, if necessary, external
                                libraries used in the <span class="emphasis"><strong>Main code</strong></span> box
                                of the <span class="emphasis"><strong>Basic settings</strong></span> view.</p>
                        </td></tr><tr><td>
                            <p>&nbsp;</p>
                        </td><td valign="top">
                            <p><span class="emphasis"><em>tStatCatcher Statistics</em></span></p>
                        </td><td valign="top">
                            <p>Select this check box to gather the Job processing metadata at a
                                job level as well as at each component level.</p>
                        </td></tr><tr><td valign="top">
                            <p><span class="emphasis"><strong>Usage</strong></span></p>
                        </td><td colspan="2" valign="top">
                            <p>You can use this component as a start, intermediate or output
                                component. You can as well use it as a one-component subjob.</p>
                        </td></tr><tr><td valign="top">
                            <p><span class="emphasis"><strong>Limitation</strong></span></p>
                        </td><td colspan="2" valign="top">
                            <p>You should know the Java language.</p>
                        </td></tr></tbody></table></div></div><div class="section" title="Scenario&nbsp;1: Generating data flow"><div class="titlepage"><div><div><h3 class="title"><a name="d0e56203"></a>Scenario&nbsp;1: Generating data flow</h3></div></div></div><p>This scenario describes a two-components Job that generates a three-line data flow
            describing different personal titles (Miss, Mrs, and Mr) and displaying them on the
            console.</p><div class="mediaobject"><img src="../images/Use_Case_tJavaFlex1_1.png"></div><div class="section" title="Setting up the Job"><div class="titlepage"><div><div><h4 class="title"><a name="d0e56211"></a>Setting up the Job</h4></div></div></div><div class="procedure"><ol class="procedure" type="1"><li class="step" title="Step 1"><p>Drop <span class="emphasis"><strong>tJavaFlex</strong></span> and <span class="emphasis"><strong>tLogRow</strong></span> from the <span class="emphasis"><strong>Palette
                        </strong></span>onto the design workspace.</p></li><li class="step" title="Step 2"><p>Connect the components together using a <span class="emphasis"><strong>Row</strong></span> &gt; <span class="emphasis"><strong>Main</strong></span> link.</p></li></ol></div></div><div class="section" title="Configuring the tJavaFlex component"><div class="titlepage"><div><div><h4 class="title"><a name="d0e56236"></a>Configuring the tJavaFlex component</h4></div></div></div><div class="procedure"><ol class="procedure" type="1"><li class="step" title="Step 1"><p>Double-click <span class="emphasis"><strong>tJavaFlex</strong></span> to display its
                            <span class="emphasis"><strong>Basic settings</strong></span> view and define its
                        properties.</p><div class="mediaobject"><img src="../images/Use_Case_tJavaFlex1_2.png"></div></li><li class="step" title="Step 2"><p>Click
                        the three-dot button next to <span class="emphasis"><strong>Edit schema</strong></span> to
                        open the corresponding dialog box where you can define the data structure to
                        pass to the component that follows.</p><div class="mediaobject"><img src="../images/Use_Case_tJavaFlex1_3.png"></div></li><li class="step" title="Step 3"><p>Click the <span class="emphasis"><strong>[+]</strong></span> button to add two columns:
                            <span class="emphasis"><em>key</em></span> and <span class="emphasis"><em>value</em></span> and then set
                        their types to <span class="emphasis"><strong>Integer</strong></span> and <span class="emphasis"><strong>String </strong></span>respectively.</p></li><li class="step" title="Step 4"><p>Click <span class="emphasis"><strong>OK </strong></span>to validate your changes and
                        close the dialog box. </p></li><li class="step" title="Step 5"><p>In the <span class="emphasis"><strong>Basic settings</strong></span> view of <span class="emphasis"><strong>tJavaFlex</strong></span>, select the <span class="emphasis"><strong>Data
                            Auto Propagate</strong></span> check box to automatically propagate data to
                        the component that follows.</p><p>In this example, we do not want to do any transformation on the retrieved
                        data.</p></li><li class="step" title="Step 6"><p>In the <span class="emphasis"><strong>Start code</strong></span> field, enter the code
                        to be executed in the initialization phase. </p><p>In this example, the code indicates the initialization of <span class="emphasis"><strong>tJavaFlex</strong></span> by displaying the START message and
                        sets up the loop and the variables to be used afterwards in the Java
                        code:</p><p>
                        </p><pre class="programlisting">System.out.println("## START\n#");<span></span>
String [] valueArray = {"Miss", "Mrs", "Mr"};<span></span>
<span></span>
for (int i=0;i&lt;valueArray.length;i++) {</pre><p>
                    </p></li><li class="step" title="Step 7"><p>In the <span class="emphasis"><strong>Main code</strong></span> field, enter the code
                        you want to apply on each of the data rows. </p><p>In this example, we want to display each key with its value:</p><p>
                        </p><pre class="programlisting">row1.key = i;<span></span>
row1.value = valueArray[i];</pre><p>
                    </p><div class="mediaobject"><img src="../images/Use_Case_tJavaFlex1_4.png"></div><div class="warning" title="Warning" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Warning</h3><p><span class="emphasis"><em>In the <span class="emphasis"><strong>Main
                                    code</strong></span> field, "row1" corresponds to the name of the
                                link that comes out of <span class="emphasis"><strong>tJavaFlex</strong></span>.
                                If you rename this link, you have to modify the code of this field
                                accordingly.</em></span></p></div></li><li class="step" title="Step 8"><p>In the <span class="emphasis"><strong>End code</strong></span> field, enter the code
                        that will be executed in the closing phase.</p><p>In this example, the brace (curly bracket) closes the loop and the code
                        indicates the end of the execution of <span class="emphasis"><strong>tJavaFlex</strong></span> by displaying the END message:</p><p>
                        </p><pre class="programlisting">}<span></span>
System.out.println("#\n## END");</pre><p>
                    </p><div class="mediaobject"><img src="../images/Use_Case_tJavaFlex1_5.png"></div></li><li class="step" title="Step 9"><p>If needed, double-click <span class="emphasis"><strong>tLogRow </strong></span>and in
                        its <span class="emphasis"><strong>Basic settings</strong></span> view, click the
                            <span class="emphasis"><strong>[...]</strong></span> button next to <span class="emphasis"><strong>Edit schema</strong></span> to make sure that the schema has been
                        correctly propagated.</p></li></ol></div></div><div class="section" title="Saving and executing the Job"><div class="titlepage"><div><div><h4 class="title"><a name="d0e56386"></a>Saving and executing the Job</h4></div></div></div><div class="procedure"><ol class="procedure" type="1"><li class="step" title="Step 1"><p>Save your Job by pressing <span class="emphasis"><strong>Ctrl+S</strong></span>.</p></li><li class="step" title="Step 2"><p>Execute the Job by pressing <span class="emphasis"><strong>F6</strong></span> or
                        clicking <span class="emphasis"><strong>Run</strong></span> on the <span class="emphasis"><strong>Run</strong></span> tab.</p><div class="mediaobject"><img src="../images/Use_Case_tJavaFlex1_6.png"></div><p>The three personal titles are displayed on the console along with their
                        corresponding keys. </p></li></ol></div></div></div><div class="section" title="Scenario&nbsp;2: Processing rows of data with tJavaFlex"><div class="titlepage"><div><div><h3 class="title"><a name="d0e56413"></a>Scenario&nbsp;2: Processing rows of data with tJavaFlex</h3></div></div></div><p>This scenario describes a two-component Job that generates random data and then
            collects that data and does some transformation on it line by line using Java code
            through the <span class="emphasis"><strong>tJavaFlex </strong></span>component.</p><div class="mediaobject"><img src="../images/Use_Case_tJavaFlex2_1.png"></div><div class="section" title="Setting up the Job"><div class="titlepage"><div><div><h4 class="title"><a name="d0e56424"></a>Setting up the Job</h4></div></div></div><div class="procedure"><ol class="procedure" type="1"><li class="step" title="Step 1"><p>Drop <span class="emphasis"><strong>tRowGenerator</strong></span> and <span class="emphasis"><strong>tJavaFlex</strong></span> from the <span class="emphasis"><strong>Palette
                        </strong></span>onto the design workspace.</p></li><li class="step" title="Step 2"><p>Connect the components together using a <span class="emphasis"><strong>Row
                            Main</strong></span> link.</p></li></ol></div></div><div class="section" title="Configuring the input component"><div class="titlepage"><div><div><h4 class="title"><a name="d0e56446"></a>Configuring the input component</h4></div></div></div><div class="procedure"><ol class="procedure" type="1"><li class="step" title="Step 1"><p>Double-click <span class="emphasis"><strong>tRowGenerator</strong></span> to display its
                            <span class="emphasis"><strong>Basic settings</strong></span> view and the <span class="emphasis"><strong>[RowGenerator Editor]</strong></span> dialog box where you can
                        define the component properties. </p><div class="mediaobject"><img src="../images/Use_Case_tJavaFlex2_2.png"></div></li><li class="step" title="Step 2"><p>Click the plus button to add four columns: <span class="emphasis"><em>number</em></span>,
                            <span class="emphasis"><em>txt</em></span>, <span class="emphasis"><em>date</em></span> and
                            <span class="emphasis"><em>flag</em></span>.</p></li><li class="step" title="Step 3"><p>Define the schema and set the parameters to the four columns according to
                        the above capture.</p></li><li class="step" title="Step 4"><p>In the <span class="emphasis"><strong>Functions</strong></span> column, select the
                        three-dot function <span class="emphasis"><strong>[...]</strong></span> for each of the
                        defined columns.</p></li><li class="step" title="Step 5"><p>In the <span class="emphasis"><strong>Parameters</strong></span> column, enter 10
                        different parameters for each of the defined columns. These 10 parameters
                        corresponds to the data that will be randomly generated when executing
                            <span class="emphasis"><strong>tRowGenerator</strong></span>.</p></li><li class="step" title="Step 6"><p>Click <span class="emphasis"><strong>OK </strong></span>to validate your changes and
                        close the editor.</p></li></ol></div></div><div class="section" title="Configuring the tJavaFlex component"><div class="titlepage"><div><div><h4 class="title"><a name="d0e56507"></a>Configuring the tJavaFlex component</h4></div></div></div><div class="procedure"><ol class="procedure" type="1"><li class="step" title="Step 1"><p>Double-click <span class="emphasis"><strong>tJavaFlex</strong></span> to display its
                            <span class="emphasis"><strong>Basic settings</strong></span> view and define the
                        components properties.</p><div class="mediaobject"><img src="../images/Use_Case_tJavaFlex2_3.png"></div></li><li class="step" title="Step 2"><p>Click <span class="emphasis"><strong>Sync columns</strong></span> to retrieve the schema
                        from the preceding component.</p></li><li class="step" title="Step 3"><p>In the <span class="emphasis"><strong>Start code</strong></span> field, enter the code
                        to be executed in the initialization phase.</p><p>In this example, the code indicates the initialization of the <span class="emphasis"><strong>tJavaFlex</strong></span> component by displaying the START
                        message and defining the variable to be used afterwards in the Java
                        code:</p><p>
                        </p><pre class="programlisting">System.out.println("## START\n#");<span></span>
int i = 0;</pre><p>
                    </p></li><li class="step" title="Step 4"><p>In the <span class="emphasis"><strong>Main code </strong></span>field, enter the code to
                        be applied on each line of data. </p><p>In this example, we want to show the number of each line starting from 0
                        and then the number and the random text transformed to upper case and
                        finally the random date set in the editor of <span class="emphasis"><strong>tRowGenerator</strong></span>. Then, we create a condition to show if the
                        status is <span class="emphasis"><strong>true</strong></span> or <span class="emphasis"><strong>false</strong></span> and we increment the number of the line:</p><p>
                        </p><pre class="programlisting">System.out.print(" row" + i + ":");<span></span>
System.out.print("# number:" + row1.number);<span></span>
System.out.print (" | txt:" + row1.txt.toUpperCase());<span></span>
System.out.print(" | date:" + row1.date);<span></span>
if(row1.flag) System.out.println(" | flag: true");<span></span>
else  System.out.println(" | flag: false");<span></span>
<span></span>
i++;</pre><p>
                    </p><div class="mediaobject"><img src="../images/Use_Case_tJavaFlex2_4.png"></div><div class="warning" title="Warning" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Warning</h3><p><span class="emphasis"><em>In the <span class="emphasis"><strong>Main
                                    code</strong></span> field, "row1" corresponds to the name of the
                                link that connects to <span class="emphasis"><strong>tJavaFlex</strong></span>. If
                                you rename this link, you have to modify the code.</em></span></p></div></li><li class="step" title="Step 5"><p>In the <span class="emphasis"><strong>End code</strong></span> field, enter the code
                        that will be executed in the closing phase.</p><p> In this example, the code indicates the end of the execution of <span class="emphasis"><strong>tJavaFlex</strong></span> by displaying the END message:</p><pre class="programlisting">System.out.println("#\n## END");</pre><div class="mediaobject"><img src="../images/Use_Case_tJavaFlex2_5.png"></div></li></ol></div></div><div class="section" title="Saving and executing the Job"><div class="titlepage"><div><div><h4 class="title"><a name="d0e56612"></a>Saving and executing the Job</h4></div></div></div><div class="procedure"><ol class="procedure" type="1"><li class="step" title="Step 1"><p>Save your Job by pressing <span class="emphasis"><strong>Ctrl+S</strong></span>.</p></li><li class="step" title="Step 2"><p>Execute the Job by pressing <span class="emphasis"><strong>F6</strong></span> or
                        clicking <span class="emphasis"><strong>Run</strong></span> on the <span class="emphasis"><strong>Run</strong></span> tab.</p><div class="mediaobject"><img src="../images/Use_Case_tJavaFlex2_6.png"></div><p>The console displays the randomly generated data that was modified by the
                        java command set through <span class="emphasis"><strong>tJavaFlex</strong></span>.</p></li></ol></div></div></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="tJava.html">Prev</a>&nbsp;</td><td width="20%" align="center"><a accesskey="u" href="ch-customcode.html">Up</a></td><td width="40%" align="right">&nbsp;<a accesskey="n" href="tJavaRow.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">tJava&nbsp;</td><td width="20%" align="center"><a accesskey="h" href="bk-tos-components-rg-en..html">Home</a></td><td width="40%" align="right" valign="top">&nbsp;tJavaRow</td></tr></table></div></body></html>