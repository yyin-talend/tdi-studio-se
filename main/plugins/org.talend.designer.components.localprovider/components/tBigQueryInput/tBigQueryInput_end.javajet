<%@ jet 
imports="
        org.talend.core.model.process.INode 
        org.talend.designer.codegen.config.CodeGeneratorArgument
		org.talend.core.model.process.ElementParameterParser 
" 
%>
	<%@ include file="@{org.talend.designer.components.localprovider}/components/templates/Log4j/Log4jFileUtil.javajet"%>
	<%
    CodeGeneratorArgument codeGenArgument = (CodeGeneratorArgument) argument;
    INode node = (INode)codeGenArgument.getArgument();
    String cid = node.getUniqueName();
    String authMode = ElementParameterParser.getValue(node,"__AUTH_MODE__");
    String projectId = ElementParameterParser.getValue(node,"__PROJECT_ID__");
    String resultSizeType = ElementParameterParser.getValue(node,"__RESULT_SIZE__");
	
	if (authMode.equals("OAUTH")) {
	%>
			}
		pageToken_<%=cid%> = dataList_<%=cid %>.getPageToken();
		if (null == pageToken_<%=cid%>) {
			break;
		}
	}
	bigQueryUtil_<%=cid%>.cleanup();
  	<%
  	} else if (authMode.equals("SERVICEACCOUNT")) {
  	%>
  		}
        <% if (resultSizeType.equals("LARGE") || resultSizeType.equals("AUTO")) {  %>
					com.google.cloud.bigquery.DatasetId datasetId = com.google.cloud.bigquery.DatasetId.of(<%=projectId%>, tempDataset);
					bigquery_<%=cid%>.delete(datasetId, com.google.cloud.bigquery.BigQuery.DatasetDeleteOption.deleteContents());
        <% }%> 
  	<%
  	} else {
		throw new IllegalArgumentException("authentication mode should be either \"SERVICEACCOUNT\" or \"OAUTH\", but it is " + authMode);
  	}
	log4jFileUtil.retrievedDataNumberInfo(node);
	%>