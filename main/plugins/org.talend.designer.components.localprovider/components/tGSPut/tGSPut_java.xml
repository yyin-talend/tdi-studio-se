<COMPONENT>

    <HEADER
            PLATEFORM="ALL"
            SERIAL=""
            VERSION="0.102"
            STATUS="ALPHA"

            COMPATIBILITY="ALL"
            AUTHOR="Talend"
            RELEASE_DATE="20130903A"
            STARTABLE="true"
            LOG4J_ENABLED="true"
    >
        <SIGNATURE/>
    </HEADER>

    <FAMILIES>
        <FAMILY>Big Data/Google Storage</FAMILY>
        <FAMILY>Cloud/Google Storage</FAMILY>
    </FAMILIES>

    <DOCUMENTATION>
        <URL/>
    </DOCUMENTATION>

    <CONNECTORS>
        <CONNECTOR CTYPE="FLOW" MAX_INPUT="0" MAX_OUTPUT="0"/>
        <CONNECTOR CTYPE="ITERATE" MAX_OUTPUT="1"/>
        <CONNECTOR CTYPE="SUBJOB_OK" MAX_INPUT="1" />
        <CONNECTOR CTYPE="SUBJOB_ERROR" MAX_INPUT="1" />
        <CONNECTOR CTYPE="COMPONENT_OK"/>
        <CONNECTOR CTYPE="COMPONENT_ERROR"/>
        <CONNECTOR CTYPE="RUN_IF"/>
    </CONNECTORS>

    <PARAMETERS>

        <PARAMETER
                NAME="USE_EXISTING_CONNECTION"
                FIELD="CHECK"
                NUM_ROW="5"
                GROUP="CONNECTION_CONFIG"
        >
            <DEFAULT>false</DEFAULT>
        </PARAMETER>

        <PARAMETER
                NAME="CONNECTION"
                FIELD="COMPONENT_LIST"
                REQUIRED="true" FILTER="tGSConnection"
                NUM_ROW="5"
                SHOW_IF="USE_EXISTING_CONNECTION == 'true'"
                GROUP="CONNECTION_CONFIG"
        />

        <PARAMETER
			NAME="AUTH_TYPE"
			FIELD="CLOSED_LIST"
			NUM_ROW="10"
			SHOW_IF="USE_EXISTING_CONNECTION == 'false'"
			GROUP="CONNECTION_CONFIG">
			<ITEMS DEFAULT="SERVICE_ACCOUNT">
				<ITEM NAME="USER_ACCOUNT_HMAC" VALUE="USER_ACCOUNT_HMAC"/>
				<ITEM NAME="SERVICE_ACCOUNT" VALUE="SERVICE_ACCOUNT"/>
				<ITEM NAME="TOKEN" VALUE="TOKEN" />
			</ITEMS>
		</PARAMETER>

        <PARAMETER
                NAME="ACCESS_KEY"
                FIELD="TEXT"
                NUM_ROW="20"
                REQUIRED_IF="(USE_EXISTING_CONNECTION == 'false') AND (AUTH_TYPE == 'USER_ACCOUNT_HMAC')"
                GROUP="CONNECTION_CONFIG"
                SHOW_IF="(USE_EXISTING_CONNECTION == 'false') AND (AUTH_TYPE == 'USER_ACCOUNT_HMAC')"
        >
            <DEFAULT>""</DEFAULT>
        </PARAMETER>

        <PARAMETER
                NAME="SECRET_KEY"
                FIELD="PASSWORD"
                NUM_ROW="20"
                REQUIRED_IF="(USE_EXISTING_CONNECTION == 'false') AND (AUTH_TYPE == 'USER_ACCOUNT_HMAC')"
                GROUP="CONNECTION_CONFIG"
                SHOW_IF="(USE_EXISTING_CONNECTION == 'false') AND (AUTH_TYPE == 'USER_ACCOUNT_HMAC')"
        >
            <DEFAULT>""</DEFAULT>
        </PARAMETER>

		<PARAMETER
			NAME="SERVICE_ACCOUNT_KEY"
			FIELD="FILE"
			NUM_ROW="30"
			REQUIRED_IF="(USE_EXISTING_CONNECTION == 'false') AND (AUTH_TYPE == 'SERVICE_ACCOUNT')"
			SHOW_IF="(USE_EXISTING_CONNECTION == 'false') AND (AUTH_TYPE == 'SERVICE_ACCOUNT')"
			GROUP="CONNECTION_CONFIG">
			<DEFAULT>"__COMP_DEFAULT_FILE_DIR__/key.json"</DEFAULT>
		</PARAMETER>

    <PARAMETER
      NAME="GS_ACCESS_TOKEN"
      FIELD="PASSWORD"
      NUM_ROW="30"
      REQUIRED="true"
      SHOW_IF="(USE_EXISTING_CONNECTION == 'false') AND (AUTH_TYPE == 'TOKEN')"
      GROUP="CONNECTION_CONFIG">
      <DEFAULT>""</DEFAULT>
    </PARAMETER>
    <PARAMETER
      NAME="GS_ACCESS_TOKEN_WARNING"
      FIELD="LABEL"
      NUM_ROW="31"
      REQUIRED="false"
      GROUP="CONNECTION_CONFIG"
      SHOW_IF="(USE_EXISTING_CONNECTION == 'false') AND (AUTH_TYPE == 'TOKEN')">
      <DEFAULT>*Note: If the Access Token Expire we won't be able to refresh it!"</DEFAULT>
    </PARAMETER>
    <PARAMETER
        NAME="GS_PROJECT_ID"
        FIELD="TEXT"
        NUM_ROW="32"
        REQUIRED="true"
        SHOW_IF="(USE_EXISTING_CONNECTION == 'false') AND (AUTH_TYPE == 'TOKEN')"
        GROUP="CONNECTION_CONFIG">
        <DEFAULT>""</DEFAULT>
      </PARAMETER>

        <PARAMETER
                NAME="BUCKET"
                FIELD="TEXT"
                NUM_ROW="40"
                REQUIRED="true"
        >
            <DEFAULT>""</DEFAULT>
        </PARAMETER>

        <PARAMETER
                NAME="LOCALDIR"
                FIELD="DIRECTORY"
                REQUIRED="true"
                NUM_ROW="50"
        >
            <DEFAULT>""</DEFAULT>
        </PARAMETER>

        <PARAMETER
                NAME="REMOTEDIR"
                FIELD="TEXT"
                REQUIRED="true"
                NUM_ROW="60"
        >
            <DEFAULT>""</DEFAULT>
        </PARAMETER>

        <PARAMETER
                NAME="USE_FILES_LIST"
                FIELD="CHECK"
                NUM_ROW="70"
        >
            <DEFAULT>false</DEFAULT>
        </PARAMETER>

        <PARAMETER
                NAME="FILES"
                FIELD="TABLE"
                REQUIRED_IF="false"
                NUM_ROW="80"
                NB_LINES="5"
                SHOW_IF="USE_FILES_LIST == 'true'"
        >
            <ITEMS>
                <ITEM NAME="FILEMASK" VALUE="&quot;&quot;"/>
                <ITEM NAME="NEWNAME" VALUE="&quot;&quot;"/>
            </ITEMS>
        </PARAMETER>

        <PARAMETER
                NAME="DIE_ON_ERROR"
                FIELD="CHECK"
                NUM_ROW="90"
        >
            <DEFAULT>false</DEFAULT>
        </PARAMETER>

    </PARAMETERS>

    <ADVANCED_PARAMETERS>

		<PARAMETER
                NAME="PART_SIZE"
                FIELD="TEXT"
                NUM_ROW="1"
				SHOW_IF="((USE_EXISTING_CONNECTION == 'true') AND ((#LINK@NODE.CONNECTION.AUTH_TYPE == 'SERVICE_ACCOUNT') OR (#LINK@NODE.CONNECTION.AUTH_TYPE == 'TOKEN')))
                  OR ((USE_EXISTING_CONNECTION == 'false') AND ((AUTH_TYPE == 'SERVICE_ACCOUNT') OR (AUTH_TYPE == 'TOKEN')))"
        >
            <DEFAULT>50</DEFAULT>
        </PARAMETER>

    </ADVANCED_PARAMETERS>

    <CODEGENERATION>
        <IMPORTS>
			<!-- USER_ACCOUNT_HMAC -->
			<IMPORT NAME="jets3t-0.9.1" MODULE="jets3t-0.9.1.jar" MVN="mvn:org.talend.libraries/jets3t-0.9.1/6.0.0"  REQUIRED_IF="(#LINK@NODE.CONNECTION.AUTH_TYPE == 'USER_ACCOUNT_HMAC') OR (AUTH_TYPE == 'USER_ACCOUNT_HMAC')" />
            <IMPORT NAME="google-storage-utils-1.1.0" MODULE="google-storage-utils-1.1.0.jar" MVN="mvn:org.talend.components/google-storage-utils/1.1.0" REQUIRED="true" />
			<IMPORT NAME="commons-logging-1.2" MODULE="commons-logging-1.2.jar" MVN="mvn:commons-logging/commons-logging/1.2" REQUIRED="true" />
			<IMPORT NAME="httpclient-4.5.12" MODULE="httpclient-4.5.12.jar" MVN="mvn:org.apache.httpcomponents/httpclient/4.5.12" REQUIRED="true" />
			<IMPORT NAME="httpcore-4.4.13" MODULE="httpcore-4.4.13.jar" MVN="mvn:org.apache.httpcomponents/httpcore/4.4.13" REQUIRED="true" />
			<IMPORT NAME="commons-codec-1.14" MODULE="commons-codec-1.14.jar" MVN="mvn:commons-codec/commons-codec/1.14" REQUIRED="true" />

			<!-- SERVICE_ACCOUNT -->
			<IMPORT NAME="google-auth-library-oauth2-http-0.20.0" MODULE="google-auth-library-oauth2-http-0.20.0.jar" MVN="mvn:com.google.auth/google-auth-library-oauth2-http/0.20.0" REQUIRED_IF="(USE_EXISTING_CONNECTION == 'false') AND ((AUTH_TYPE == 'SERVICE_ACCOUNT') OR (AUTH_TYPE == 'TOKEN'))" />
				<!-- Transitive dependencies of google-auth-library-oauth2-http -->
				<IMPORT NAME="google-auth-library-credentials-0.20.0" MODULE="google-auth-library-credentials-0.20.0.jar" MVN="mvn:com.google.auth/google-auth-library-credentials/0.20.0" REQUIRED_IF="(USE_EXISTING_CONNECTION == 'false') AND ((AUTH_TYPE == 'SERVICE_ACCOUNT') OR (AUTH_TYPE == 'TOKEN'))" />
				<IMPORT NAME="google-http-client-1.25.0" MODULE="google-http-client-1.25.0.jar" MVN="mvn:com.google.http-client/google-http-client/1.25.0" REQUIRED_IF="(USE_EXISTING_CONNECTION == 'false') AND ((AUTH_TYPE == 'SERVICE_ACCOUNT') OR (AUTH_TYPE == 'TOKEN'))" />
				<IMPORT NAME="google-http-client-jackson2-1.25.0" MODULE="google-http-client-jackson2-1.25.0.jar" MVN="mvn:com.google.http-client/google-http-client-jackson2/1.25.0" REQUIRED_IF="(USE_EXISTING_CONNECTION == 'false') AND ((AUTH_TYPE == 'SERVICE_ACCOUNT') OR (AUTH_TYPE == 'TOKEN'))" />
				<IMPORT NAME="jackson-core-2.10.1" MODULE="jackson-core-2.10.1.jar" MVN="mvn:com.fasterxml.jackson.core/jackson-core/2.10.1" REQUIRED_IF="(USE_EXISTING_CONNECTION == 'false') AND ((AUTH_TYPE == 'SERVICE_ACCOUNT') OR (AUTH_TYPE == 'TOKEN'))" />
				<IMPORT NAME="guava-30.0-jre.jar" MODULE="guava-30.0-jre.jar" MVN="mvn:com.google.guava/guava/30.0-jre" REQUIRED_IF="(USE_EXISTING_CONNECTION == 'false') AND ((AUTH_TYPE == 'SERVICE_ACCOUNT') OR (AUTH_TYPE == 'TOKEN'))" />
				<IMPORT NAME="failureaccess-1.0.1.jar" MODULE="failureaccess-1.0.1.jar" MVN="mvn:com.google.guava/failureaccess/1.0.1" REQUIRED="true" />
			<IMPORT NAME="google-cloud-storage-1.104.0" MODULE="google-cloud-storage-1.104.0.jar" MVN="mvn:com.google.cloud/google-cloud-storage/1.104.0" REQUIRED_IF="(USE_EXISTING_CONNECTION == 'false') AND ((AUTH_TYPE == 'SERVICE_ACCOUNT') OR (AUTH_TYPE == 'TOKEN'))" />
				<!-- Transitive dependencies of google-cloud-storage -->
				<IMPORT NAME="google-cloud-core-1.93.4.jar" MODULE="google-cloud-core-1.93.4.jar" MVN="mvn:com.google.cloud/google-cloud-core/1.93.4" REQUIRED_IF="(USE_EXISTING_CONNECTION == 'false') AND ((AUTH_TYPE == 'SERVICE_ACCOUNT') OR (AUTH_TYPE == 'TOKEN'))" />
				<IMPORT NAME="google-api-client-1.25.0.jar" MODULE="google-api-client-1.25.0.jar" MVN="mvn:com.google.api-client/google-api-client/1.25.0" REQUIRED_IF="(USE_EXISTING_CONNECTION == 'false') AND ((AUTH_TYPE == 'SERVICE_ACCOUNT') OR (AUTH_TYPE == 'TOKEN'))" />
				<IMPORT NAME="google-oauth-client-1.31.0.jar" MODULE="google-oauth-client-1.31.0.jar" MVN="mvn:com.google.oauth-client/google-oauth-client/1.31.0" REQUIRED_IF="(USE_EXISTING_CONNECTION == 'false') AND ((AUTH_TYPE == 'SERVICE_ACCOUNT') OR (AUTH_TYPE == 'TOKEN'))" />
				<IMPORT NAME="google-api-services-storage-v1-rev20191011-1.30.3" MODULE="google-api-services-storage-v1-rev20191011-1.30.3.jar" MVN="mvn:com.google.apis/google-api-services-storage/v1-rev20191011-1.30.3" REQUIRED_IF="(USE_EXISTING_CONNECTION == 'false') AND ((AUTH_TYPE == 'SERVICE_ACCOUNT') OR (AUTH_TYPE == 'TOKEN'))" />
				<IMPORT NAME="gson-2.8.6" MODULE="gson-2.8.6.jar" MVN="mvn:com.google.code.gson/gson/2.8.6" REQUIRED_IF="(USE_EXISTING_CONNECTION == 'false') AND ((AUTH_TYPE == 'SERVICE_ACCOUNT') OR (AUTH_TYPE == 'TOKEN'))" />
				<IMPORT NAME="api-common-1.6.0" MODULE="api-common-1.6.0.jar" MVN="mvn:com.google.api/api-common/1.6.0" REQUIRED_IF="(USE_EXISTING_CONNECTION == 'false') AND ((AUTH_TYPE == 'SERVICE_ACCOUNT') OR (AUTH_TYPE == 'TOKEN'))" />
				<IMPORT NAME="javax.annotation-api" MODULE="javax.annotation-api-1.3.jar" MVN="mvn:javax.annotation/javax.annotation-api/1.3" REQUIRED_IF="(USE_EXISTING_CONNECTION == 'false') AND ((AUTH_TYPE == 'SERVICE_ACCOUNT') OR (AUTH_TYPE == 'TOKEN'))" />
				<IMPORT NAME="gax-1.27.0" MODULE="gax-1.27.0.jar" MVN="mvn:com.google.api/gax/1.27.0" REQUIRED_IF="(USE_EXISTING_CONNECTION == 'false') AND ((AUTH_TYPE == 'SERVICE_ACCOUNT') OR (AUTH_TYPE == 'TOKEN'))" />
				<IMPORT NAME="gax-httpjson-0.44.0" MODULE="gax-httpjson-0.44.0.jar" MVN="mvn:com.google.api/gax-httpjson/0.44.0" REQUIRED_IF="(USE_EXISTING_CONNECTION == 'false') AND ((AUTH_TYPE == 'SERVICE_ACCOUNT') OR (AUTH_TYPE == 'TOKEN'))" />
				<IMPORT NAME="threetenbp-1.3.3.jar" MODULE="threetenbp-1.3.3.jar" MVN="mvn:org.threeten/threetenbp/1.3.3" REQUIRED_IF="(USE_EXISTING_CONNECTION == 'false') AND ((AUTH_TYPE == 'SERVICE_ACCOUNT') OR (AUTH_TYPE == 'TOKEN'))" />
				<IMPORT NAME="protobuf-java-2.5.0" MODULE="protobuf-java-2.5.0.jar" MVN="mvn:com.google.protobuf/protobuf-java/2.5.0" REQUIRED_IF="(USE_EXISTING_CONNECTION == 'false') AND ((AUTH_TYPE == 'SERVICE_ACCOUNT') OR (AUTH_TYPE == 'TOKEN'))" />
				<IMPORT NAME="error_prone_annotation-2.1.3" MODULE="error_prone_annotation-2.1.3.jar" MVN="mvn:com.google.errorprone/error_prone_annotations/2.1.3" REQUIRED_IF="(USE_EXISTING_CONNECTION == 'false') AND ((AUTH_TYPE == 'SERVICE_ACCOUNT') OR (AUTH_TYPE == 'TOKEN'))" />
				<IMPORT NAME="google-cloud-core-http-1.32.0.jar" MODULE="google-cloud-core-http-1.32.0.jar" MVN="mvn:com.google.cloud/google-cloud-core-http/1.32.0" REQUIRED_IF="(USE_EXISTING_CONNECTION == 'false') AND ((AUTH_TYPE == 'SERVICE_ACCOUNT') OR (AUTH_TYPE == 'TOKEN'))" />
				<IMPORT NAME="google-http-client-appengine-1.25.0.jar" MODULE="google-http-client-appengine-1.25.0.jar" MVN="mvn:com.google.http-client/google-http-client-appengine/1.25.0" REQUIRED_IF="(USE_EXISTING_CONNECTION == 'false') AND ((AUTH_TYPE == 'SERVICE_ACCOUNT') OR (AUTH_TYPE == 'TOKEN'))" />
				<IMPORT NAME="opencensus-api-0.21.0" MODULE="opencensus-api-0.21.0.jar" MVN="mvn:io.opencensus/opencensus-api/0.21.0" REQUIRED_IF="(USE_EXISTING_CONNECTION == 'false') AND ((AUTH_TYPE == 'SERVICE_ACCOUNT') OR (AUTH_TYPE == 'TOKEN'))" />
				<IMPORT NAME="opencensus-contrib-http-util-0.21.0" MODULE="opencensus-contrib-http-util-0.21.0.jar" MVN="mvn:io.opencensus/opencensus-contrib-http-util/0.21.0" REQUIRED_IF="(USE_EXISTING_CONNECTION == 'false') AND ((AUTH_TYPE == 'SERVICE_ACCOUNT') OR (AUTH_TYPE == 'TOKEN'))" />
				<IMPORT NAME="grpc-context-1.19.0" MODULE="grpc-context-1.19.0.jar" MVN="mvn:io.grpc/grpc-context/1.19.0" REQUIRED_IF="(USE_EXISTING_CONNECTION == 'false') AND ((AUTH_TYPE == 'SERVICE_ACCOUNT') OR (AUTH_TYPE == 'TOKEN'))" />
				<IMPORT NAME="proto-google-common-protos-1.17.0" MODULE="proto-google-common-protos-1.17.0.jar" MVN="mvn:com.google.api.grpc/proto-google-common-protos/1.17.0" REQUIRED_IF="(USE_EXISTING_CONNECTION == 'false') AND ((AUTH_TYPE == 'SERVICE_ACCOUNT') OR (AUTH_TYPE == 'TOKEN'))" />
				<IMPORT NAME="proto-google-iam-v1-0.13.0" MODULE="proto-google-iam-v1-0.13.0.jar" MVN="mvn:com.google.api.grpc/proto-google-iam-v1/0.13.0" REQUIRED_IF="(USE_EXISTING_CONNECTION == 'false') AND ((AUTH_TYPE == 'SERVICE_ACCOUNT') OR (AUTH_TYPE == 'TOKEN'))" />
				<IMPORT NAME="protobuf-java-util-3.11.4" MODULE="protobuf-java-util-3.11.4.jar" MVN="mvn:com.google.protobuf/protobuf-java-util/3.11.4" REQUIRED_IF="(USE_EXISTING_CONNECTION == 'false') AND ((AUTH_TYPE == 'SERVICE_ACCOUNT') OR (AUTH_TYPE == 'TOKEN'))" />
				<IMPORT NAME="annotation-1.1.0" MODULE="annotation-1.1.0.jar" MVN="mvn:androidx.annotation/annotation/1.1.0" REQUIRED_IF="(USE_EXISTING_CONNECTION == 'false') AND ((AUTH_TYPE == 'SERVICE_ACCOUNT') OR (AUTH_TYPE == 'TOKEN'))" />
        </IMPORTS>
    </CODEGENERATION>

    <RETURNS>
        <RETURN NAME="NB_LINE" TYPE="id_Integer" AVAILABILITY="AFTER" />
    </RETURNS>
</COMPONENT>
